/******************************************************************************
*                      Includes
******************************************************************************/
#include <avr/io.h>

#include <util/delay.h>
#include"AFS_servo.h"
/******************************************************************************
*                      Defines and data types
******************************************************************************/

/******************************************************************************
*                      Global variables
******************************************************************************/

/******************************************************************************
*                      Static variables
******************************************************************************/
/******************************************************************************
*                      Internal function prototypes
******************************************************************************/


/******************************************************************************
*                      Public functions
******************************************************************************/


void AFS_servo_init(){

// Mode selection
TCCR1A|=(1<<WGM10);
TCCR1A&=~(1<<WGM11);
TCCR1B|=(1<<WGM12);
TCCR1B&=~(1<<WGM13);
TCCR1B|=((1<<CS12)|(1<<CS10));
TCCR1B&=~(1<<CS11);
TCNT1H=0x00;
TCNT1L=0x00;

// setting behaviour for pin PB1
TCCR1A|=(1<<COM1A1);
TCCR1A&=~(1<<COM1A0);


//setting behaviour for pin PB12
TCCR1A|=(1<<COM1B1);
TCCR1A&=~(1<<COM1B0);

//setting PB1 and PB2 as output
DDRB|=(1<<PB1);
DDRB|=(1<<PB2);
}



void AFS_servo_degrees(int pin, int degrees){

int scaledDegrees = ((7.8*degrees)/90);

if(pin == PB1)
{
OCR1A=scaledDegrees + 15;
}

 if(pin==PB2)
 {
  OCR1B=scaledDegrees + 15;
 }
 }


